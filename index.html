<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scary Search Loading</title>
    <style>
        :root {
            --accent: #e74c3c;
            --accent-glow: rgba(231, 76, 60, 0.5);
            --secondary: #f39c12; 
        }
        body {
            background-color: #050505;
            color: #ffffff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            user-select: none;
            cursor: none;
        }
        #bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(20,20,20,1) 0%, rgba(0,0,0,1) 100%);
            z-index: -3;
            transition: background 0.5s ease;
        }
        
        /* Стили для всех Canvas фонов */
        #topo-canvas, #stars-canvas, #sakura-canvas, #rift-canvas, #secret-canvas, #teto-canvas, #brainrot-canvas, #frisk-canvas, #sans-canvas, #tower-defense-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            display: none; 
        }

        #topo-canvas {
            z-index: -2; 
            mix-blend-mode: screen; 
            opacity: 0.6;
        }
        
        #stars-canvas, #sakura-canvas, #rift-canvas, #secret-canvas, #teto-canvas, #brainrot-canvas, #frisk-canvas, #sans-canvas, #tower-defense-canvas {
            z-index: -1;
        }

        /* Стиль для GIF Санса */
        #sans-gif {
            position: absolute;
            top: 45%; 
            left: 50%;
            transform: translate(-50%, -50%);
            max-height: 70vh; 
            max-width: 90vw;
            z-index: -1;
            display: none; 
            /* УБРАЛИ ПОДСВЕТКУ (filter: drop-shadow) */
        }

        #rift-canvas {
            filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.2));
        }

        #visualizer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40%;
            z-index: 0;
            opacity: 0.8;
            pointer-events: none;
        }
        #content {
            width: 80%;
            max-width: 800px;
            text-align: center;
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        h1 {
            font-size: 3.5em;
            font-weight: 900;
            margin: 0 0 10px 0;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 5px;
            text-shadow: 0 0 20px var(--accent-glow);
            transition: transform 0.05s ease-out;
        }
        #main-status {
            font-size: 1.5em;
            font-weight: 400;
            color: #ecf0f1;
            margin: 0 0 10px 0;
            opacity: 1;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
            min-height: 1.2em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }
        .progress-container {
            width: 100%;
            background: #1a1a1a;
            border-radius: 3px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            position: relative;
        }
        #progress-bg-main {
            height: 12px;
        }
        #progress-bar-main {
            height: 100%;
            width: 0%;
            background: var(--accent);
            transition: width 0.2s linear;
            box-shadow: 0 0 10px var(--accent);
        }
        #progress-bg-file {
            height: 6px;
            margin-top: -5px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        #progress-bar-file {
            height: 100%;
            width: 100%;
            background-color: var(--secondary);
            background-image: linear-gradient(
                45deg, 
                rgba(255, 255, 255, 0.2) 25%, 
                transparent 25%, 
                transparent 50%, 
                rgba(255, 255, 255, 0.2) 50%, 
                rgba(255, 255, 255, 0.2) 75%, 
                transparent 75%, 
                transparent
            );
            background-size: 20px 20px;
            box-shadow: 0 0 5px var(--secondary);
            animation: move-stripes 1s linear infinite;
        }
        @keyframes move-stripes {
            0% { background-position: 0 0; }
            100% { background-position: 20px 0; }
        }
        #tip-container {
            margin-top: 20px;
            font-size: 1.1em;
            color: #bdc3c7;
            font-style: italic;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            min-height: 1.5em;
            text-shadow: 0 0 2px rgba(0,0,0,0.8);
        }
        #tip-prefix {
            font-weight: bold;
            color: var(--secondary);
            margin-right: 5px;
            font-style: normal;
        }
        
        /* --- Developer List Styles --- */
        #dev-container {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 50;
            pointer-events: auto;
        }
        .dev-card {
            display: flex;
            align-items: center;
            background: rgba(0, 0, 0, 0.6);
            padding: 8px 12px;
            border-radius: 8px;
            border-right: 3px solid var(--accent);
            backdrop-filter: blur(5px);
            transition: transform 0.3s, background 0.3s;
            text-decoration: none;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .dev-card:hover {
            transform: translateX(-5px);
            background: rgba(255, 255, 255, 0.1);
        }
        .dev-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            margin-right: 10px;
            border: 2px solid var(--accent);
            box-sizing: border-box; 
        }
        .dev-info {
            text-align: left;
        }
        .dev-name {
            font-size: 0.9em;
            font-weight: 700;
            display: block;
        }
        .dev-role {
            font-size: 0.7em;
            color: var(--secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        #music-container {
            position: absolute;
            top: 40px;
            left: 40px;
            text-align: left;
            z-index: 50;
            opacity: 0;
            transform: translateX(-20px);
            transition: all 1s ease-out;
            border-left: 3px solid var(--accent);
            padding-left: 15px;
            cursor: pointer; 
        }
        #music-label {
            font-size: 0.8em;
            font-weight: 900;
            color: var(--accent);
            letter-spacing: 2px;
            margin-bottom: 2px;
            text-transform: uppercase;
        }
        #music-title {
            font-size: 1.4em;
            font-weight: 700;
            color: #fff;
            margin-bottom: 2px;
            text-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
        #music-author {
            font-size: 0.9em;
            color: #bdc3c7;
            font-style: italic;
        }
        #debug-log {
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-family: monospace;
            color: #333;
            font-size: 10px;
            text-align: right;
            pointer-events: none;
            z-index: 20;
        }
    </style>
</head>
<body>
    <div id="bg"></div>
    
    <canvas id="topo-canvas"></canvas>
    <canvas id="stars-canvas"></canvas>
    <canvas id="sakura-canvas"></canvas>
    <canvas id="rift-canvas"></canvas>
    <canvas id="secret-canvas"></canvas>
    <canvas id="teto-canvas"></canvas>
    <canvas id="brainrot-canvas"></canvas>
    <canvas id="frisk-canvas"></canvas>
    <canvas id="sans-canvas"></canvas>
    <canvas id="tower-defense-canvas"></canvas>
    
    <img id="sans-gif" src="sans.gif" alt="Sans" crossOrigin="Anonymous">
    
    <canvas id="visualizer"></canvas>
    <div id="debug-log"></div>

    <div id="music-container" onclick="forcePlayMusic()">
        <div id="music-label">NOW PLAYING</div>
        <div id="music-title">Loading...</div>
        <div id="music-author"></div>
    </div>

    <div id="dev-container"></div>

    <div id="content">
        <h1 id="server-name">SCARY SEARCH</h1>
        <h2 id="main-status">Connecting...</h2>
        
        <div class="progress-container" id="progress-bg-main">
            <div id="progress-bar-main"></div>
        </div>

        <div class="progress-container" id="progress-bg-file">
            <div id="progress-bar-file"></div>
        </div>

        <div id="tip-container">
            <span id="tip-prefix">TIP:</span> <span id="tip-text"></span>
        </div>
    </div>

    <script src="developers.js"></script>
    <script src="tips.js"></script>
    
    <script src="stars.js"></script>
    <script src="topo.js"></script>
    <script src="sakura.js"></script>
    <script src="rift.js"></script>
    <script src="secret.js"></script>
    <script src="teto.js"></script>
    <script src="brainrot.js"></script>
    <script src="frisk.js"></script>
    <script src="sans.js"></script> 
    <script src="tower_defense.js"></script>

    <audio id="bg-music" crossOrigin="anonymous"></audio>

    <script>
        const COLOR_SPEED = 0.2;
        const TIP_INTERVAL = 6000;
        const BAR_COUNT = 64;
        const SENSITIVITY = 1.2;
        const TARGET_VOLUME = 0.3;
        const MUSIC_FILE = 'loading_music.mp3';
        
        const elServer = document.getElementById('server-name');
        const elMainStatus = document.getElementById('main-status');
        const elBarMain = document.getElementById('progress-bar-main');
        const elBgFile = document.getElementById('progress-bg-file'); 
        const elTipContainer = document.getElementById('tip-container');
        const elTipText = document.getElementById('tip-text');
        
        const elMusicBox = document.getElementById('music-container');
        const elMusicTitle = document.getElementById('music-title');
        const elMusicAuthor = document.getElementById('music-author');
        const elDevContainer = document.getElementById('dev-container');

        const cvs = document.getElementById('visualizer');
        const ctx = cvs.getContext('2d');
        const audio = document.getElementById('bg-music');
        const debugLog = document.getElementById('debug-log');
        const root = document.documentElement;
        const bgElement = document.getElementById('bg');

        let audioCtx, analyser, source;
        let dataArray;
        let isRealtime = false;
        let retryTimer = null;
        
        let filesTotal = 0;
        let filesNeeded = 0;
        let colorHue = 0;
        
        let devAvatarElements = [];
        let originalServerName = "SCARY SEARCH"; 

        function log(msg) {
            debugLog.innerHTML += "<br>" + msg;
        }

        function resize() {
            cvs.width = window.innerWidth;
            cvs.height = window.innerHeight * 0.4;
        }
        window.addEventListener('resize', resize);
        resize();

        function initDevelopers() {
            if (typeof DEVELOPERS === 'undefined' || DEVELOPERS.length === 0) return;
            elDevContainer.innerHTML = '';
            DEVELOPERS.forEach(dev => {
                const card = document.createElement('a');
                card.className = 'dev-card';
                card.href = "https://steamcommunity.com/profiles/" + dev.steamid;
                card.target = "_blank";
                card.innerHTML = `
                    <img src="${dev.avatar}" class="dev-avatar" alt="avatar">
                    <div class="dev-info">
                        <span class="dev-name">${dev.name}</span>
                        <span class="dev-role">${dev.role}</span>
                    </div>
                `;
                elDevContainer.appendChild(card);
            });
            devAvatarElements = Array.from(document.getElementsByClassName('dev-avatar'));
        }

        function startTips() {
            if (typeof LOADING_TIPS === 'undefined' || LOADING_TIPS.length === 0) return;
            function nextTip() {
                elTipContainer.style.opacity = 0;
                setTimeout(() => {
                    const randomTip = LOADING_TIPS[Math.floor(Math.random() * LOADING_TIPS.length)];
                    elTipText.innerText = randomTip;
                    elTipContainer.style.opacity = 1;
                }, 500);
            }
            nextTip();
            setInterval(nextTip, TIP_INTERVAL);
        }

        function playMusic() {
            elMusicTitle.innerText = "Loading Music";
            elMusicAuthor.innerText = "Background Ambience";
            elMusicBox.style.opacity = 1;
            elMusicBox.style.transform = "translateX(0)";

            audio.src = MUSIC_FILE;
            audio.load(); 
            forcePlayMusic();
        }

        function forcePlayMusic() {
            if (!audio.paused) return;
            audio.volume = 0; 
            const playPromise = audio.play();
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    log("Autoplay Success");
                    if (retryTimer) clearInterval(retryTimer);
                    let vol = 0;
                    const fade = setInterval(() => {
                        vol += 0.02;
                        if (vol >= TARGET_VOLUME) {
                            vol = TARGET_VOLUME;
                            clearInterval(fade);
                        }
                        audio.volume = vol;
                    }, 100);
                }).catch(error => {
                    log("Autoplay Blocked - Retrying...");
                    if (!retryTimer) {
                        retryTimer = setInterval(forcePlayMusic, 1000); 
                    }
                });
            }
        }

        function initAudioContext() {
            if (audioCtx) return; 
            try {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                if (!AudioContext) return;
                audioCtx = new AudioContext();
                analyser = audioCtx.createAnalyser();
                analyser.fftSize = 256; 
                source = audioCtx.createMediaElementSource(audio);
                source.connect(analyser);
                analyser.connect(audioCtx.destination);
                dataArray = new Uint8Array(analyser.frequencyBinCount);
                isRealtime = true;
            } catch (e) {
                isRealtime = false;
            }
        }

        audio.addEventListener('ended', () => {
            audio.currentTime = 0;
            audio.play();
        });

        // === НОВАЯ ФУНКЦИЯ ДЛЯ АНАЛИЗА ЦВЕТА КАРТИНКИ ===
        function setBgFromImage(imgId) {
            const img = document.getElementById(imgId);
            if (!img) return;

            // Создаем невидимый канвас
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Если картинка еще не загрузилась, ждем
            if (!img.complete || img.naturalWidth === 0) {
                img.onload = () => setBgFromImage(imgId);
                return;
            }

            canvas.width = img.naturalWidth;
            canvas.height = img.naturalHeight;
            ctx.drawImage(img, 0, 0);

            try {
                // Берем пиксели и считаем самый частый цвет (упрощенно)
                const data = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
                const colorCounts = {};
                let maxCount = 0;
                let dominant = 'rgb(0,0,0)';
                
                // Проверяем каждый 50-й пиксель для скорости
                for (let i = 0; i < data.length; i += 4 * 50) {
                    const r = data[i];
                    const g = data[i+1];
                    const b = data[i+2];
                    const a = data[i+3];
                    
                    if (a < 250) continue; // Игнорируем прозрачные
                    
                    const key = `${r},${g},${b}`;
                    colorCounts[key] = (colorCounts[key] || 0) + 1;
                    
                    if (colorCounts[key] > maxCount) {
                        maxCount = colorCounts[key];
                        dominant = `rgb(${r},${g},${b})`;
                    }
                }
                
                // Устанавливаем фон
                bgElement.style.background = dominant;
                
            } catch (e) {
                // Если ошибка (например CORS), ставим черный
                console.log("Cannot extract color:", e);
                bgElement.style.background = "#000000";
            }
        }

        function switchBackground(mode) {
            const stars = document.getElementById('stars-canvas');
            const topo = document.getElementById('topo-canvas');
            const sakura = document.getElementById('sakura-canvas');
            const rift = document.getElementById('rift-canvas');
            const secret = document.getElementById('secret-canvas');
            const teto = document.getElementById('teto-canvas');
            const brainrot = document.getElementById('brainrot-canvas');
            const frisk = document.getElementById('frisk-canvas');
            const sans = document.getElementById('sans-canvas');
            const sansGif = document.getElementById('sans-gif');
            const tdCanvas = document.getElementById('tower-defense-canvas');
            
            [stars, topo, sakura, rift, secret, teto, brainrot, frisk, sans, sansGif, tdCanvas].forEach(el => {
                if(el) el.style.display = 'none';
            });
            
            // Сброс фона на стандартный
            bgElement.style.background = "radial-gradient(circle, rgba(20,20,20,1) 0%, rgba(0,0,0,1) 100%)";

            const specialNames = ["GOO GOO GAA GAA", "KASANE TETO", "LOBOTOMY KISEN", "DETERMINATION", "BAD TIME", "TOWER DEFENSE"];
            if (specialNames.includes(elServer.innerText)) {
                elServer.innerText = originalServerName;
                elServer.style.color = "";
            }

            switch(mode) {
                case 1:
                    stars.style.display = 'block';
                    if (window.initStarBackground) window.initStarBackground();
                    log("Switched to: Stars");
                    break;
                case 2:
                    topo.style.display = 'block';
                    if (window.initTopoBackground) window.initTopoBackground();
                    log("Switched to: Topography");
                    break;
                case 3:
                    sakura.style.display = 'block';
                    if (window.initSakuraBackground) window.initSakuraBackground();
                    log("Switched to: Sakura");
                    break;
                case 4:
                    rift.style.display = 'block';
                    if (window.initRiftBackground) window.initRiftBackground();
                    log("Switched to: Rift");
                    break;
                case 5:
                    secret.style.display = 'block';
                    if (window.initSecretBackground) window.initSecretBackground();
                    elServer.innerText = "GOO GOO GAA GAA";
                    elServer.style.color = "#FF00FF";
                    log("Switched to: SECRET");
                    break;
                case 6:
                    teto.style.display = 'block';
                    if (window.initTetoBackground) window.initTetoBackground();
                    elServer.innerText = "KASANE TETO";
                    elServer.style.color = "#D01328";
                    log("Switched to: TETO");
                    break;
                case 7:
                    brainrot.style.display = 'block';
                    if (window.initBrainrotBackground) window.initBrainrotBackground();
                    elServer.innerText = "LOBOTOMY KISEN";
                    elServer.style.color = "#00FF00";
                    log("Switched to: BRAINROT");
                    break;
                case 8:
                    frisk.style.display = 'block';
                    if (window.initFriskBackground) window.initFriskBackground();
                    elServer.innerText = "DETERMINATION";
                    elServer.style.color = "#FFFF00"; 
                    log("Switched to: FRISK");
                    break;
                case 9:
                    // РЕЖИМ САНСА: Определяем цвет фона по картинке
                    sans.style.display = 'block';
                    sansGif.style.display = 'block'; 
                    // Вызываем функцию анализа цвета
                    setBgFromImage('sans-gif');
                    
                    if (window.initSansBackground) window.initSansBackground();
                    elServer.innerText = "BAD TIME";
                    elServer.style.color = "#00FFFF"; 
                    log("Switched to: SANS");
                    break;
                case 10:
                    tdCanvas.style.display = 'block';
                    if (window.initTowerDefenseBackground) window.initTowerDefenseBackground();
                    elServer.innerText = "TOWER DEFENSE";
                    elServer.style.color = "#3498db";
                    log("Switched to: TOWER DEFENSE");
                    break;
            }
        }

        window.addEventListener('load', () => {
            initDevelopers();
            startTips();
            playMusic();
            animate();
            
            // --- ЛОГИКА РАНДОМА ---
            const rand = Math.random();
            
            // Teto: 0.1% (0.001)
            if (rand < 0.001) { switchBackground(6); } 
            // Sans: 0.5% (0.001 + 0.005 = 0.006)
            else if (rand < 0.006) { switchBackground(9); }
            // Frisk: 1% (0.006 + 0.01 = 0.016)
            else if (rand < 0.016) { switchBackground(8); }
            // Secret: 1% (0.016 + 0.01 = 0.026)
            else if (rand < 0.026) { switchBackground(5); }
            // Brainrot: 5% (0.026 + 0.05 = 0.076)
            else if (rand < 0.076) { switchBackground(7); }
            // Tower Defense: ~5% (0.076 + 0.05 = 0.126)
            else if (rand < 0.126) { switchBackground(10); }
            // Обычные
            else {
                const subRand = Math.random();
                if (subRand < 0.25) switchBackground(1);
                else if (subRand < 0.50) switchBackground(2);
                else if (subRand < 0.75) switchBackground(3);
                else switchBackground(4);
            }
            
            // --- ОТЛАДОЧНЫЕ КЛАВИШИ ---
            if (!window.gmod) {
                log("Debug Keys Enabled (1-9, 0)");
                document.addEventListener('keydown', (e) => {
                    if (['1','2','3','4','5','6','7','8','9','0'].includes(e.key)) {
                        let mode = parseInt(e.key);
                        if (mode === 0) mode = 10;
                        switchBackground(mode);
                    }
                });
            }

            setInterval(() => {
                if (devAvatarElements.length === 0) initDevelopers();
            }, 2000);
        });
        
        document.addEventListener('click', () => {
            initAudioContext();
            forcePlayMusic();
        });
        document.addEventListener('keydown', forcePlayMusic);

        function animate() {
            requestAnimationFrame(animate);
            if (!audioCtx && !audio.paused) initAudioContext();

            const time = audio.currentTime;
            let currentVolume = 0;
            let barData = [];

            if (isRealtime && analyser && !audio.paused) {
                analyser.getByteFrequencyData(dataArray);
                let sum = 0;
                for(let i = 0; i < dataArray.length; i++) {
                    sum += dataArray[i];
                }
                currentVolume = (sum / dataArray.length) / 255 * SENSITIVITY;
                const step = Math.floor(dataArray.length / BAR_COUNT);
                for (let i = 0; i < BAR_COUNT; i++) {
                    barData[i] = (dataArray[i * step] / 255) * SENSITIVITY;
                }
            } else {
                if (!audio.paused) {
                    currentVolume = (Math.sin(time * 5) * 0.5 + 0.5) * 0.2;
                }
                for (let i = 0; i < BAR_COUNT; i++) {
                    const wave = Math.sin(i * 0.2 + time * 3) * 0.5 + 0.5;
                    const wave2 = Math.cos(i * 0.3 - time * 2) * 0.3;
                    let val = (wave + wave2) * 0.5 * (currentVolume + 0.2);
                    const centerOffset = Math.abs(i - BAR_COUNT / 2) / (BAR_COUNT / 2);
                    val *= (1.2 - centerOffset);
                    barData[i] = val;
                }
            }

            currentVolume = Math.max(0, currentVolume);
            window.audioVisLevel = currentVolume;

            colorHue = (colorHue + COLOR_SPEED) % 360;
            const mainColor = `hsl(${colorHue}, 80%, 60%)`;
            const glowColor = `hsla(${colorHue}, 80%, 60%, 0.5)`;
            root.style.setProperty('--accent', mainColor);
            root.style.setProperty('--accent-glow', glowColor);

            const scale = 1 + (currentVolume * 0.1);
            elServer.style.transform = `scale(${scale})`;

            // Анимация аватарок
            if (devAvatarElements.length > 0) {
                const avatarScale = 1 + (currentVolume * 5.00);
                const avatarShadow = `0 0 ${5 + currentVolume * 20}px ${glowColor}`;
                for (let i = 0; i < devAvatarElements.length; i++) {
                    devAvatarElements[i].style.transform = `scale(${avatarScale})`;
                    devAvatarElements[i].style.borderColor = mainColor;
                    devAvatarElements[i].style.boxShadow = avatarShadow;
                }
            }

            ctx.clearRect(0, 0, cvs.width, cvs.height);
            const barWidth = cvs.width / BAR_COUNT;
            
            for (let i = 0; i < BAR_COUNT; i++) {
                let barHeight = barData[i] * cvs.height * 0.8;
                barHeight = Math.max(2, barHeight); 
                ctx.fillStyle = `hsla(${colorHue}, 80%, 60%, ${Math.min(1, barData[i] + 0.3)})`;
                ctx.fillRect(i * barWidth, cvs.height - barHeight, barWidth - 2, barHeight);
            }
        }

        /* --- GMOD API MOCK --- */
        function GameDetails(servername, serverurl, mapname, maxplayers, steamid, gamemode) {
            originalServerName = servername;
            const specialNames = ["GOO GOO GAA GAA", "KASANE TETO", "LOBOTOMY KISEN", "DETERMINATION", "BAD TIME", "TOWER DEFENSE"];
            if (!specialNames.includes(elServer.innerText)) {
                elServer.innerText = servername;
            }
        }

        function SetStatusChanged(status) {
            elMainStatus.innerText = status;
            if(status.indexOf("Getting Addon Info") !== -1 || status === "Sending Client Info" || status === "Mounting Addons") {
                 elBgFile.style.opacity = "0";
            }
        }

        function DownloadingFile(fileName) {
            elMainStatus.innerText = "Downloading: " + fileName;
            elBgFile.style.opacity = "1";
        }

        function SetFilesTotal(total) {
            filesTotal = total;
        }

        function SetFilesNeeded(needed) {
            filesNeeded = needed;
            if (filesTotal > 0) {
                const downloaded = filesTotal - filesNeeded;
                const percent = (downloaded / filesTotal) * 100;
                elBarMain.style.width = Math.min(percent, 100) + '%';
            }
        }
        
        if (!window.gmod && !window.gtps) {
           setTimeout(() => { 
               GameDetails("SCARY SEARCH", "", "gm_construct", 32, "0", "sandbox");
               SetStatusChanged("Preparing Assets...");
               SetFilesTotal(5);
               let needed = 5;
               const interval = setInterval(() => {
                   if(needed > 0) {
                       needed--;
                       SetFilesNeeded(needed);
                       DownloadingFile("models/scary_search/monsters/very_scary_model_" + needed + ".mdl");
                   } else {
                       clearInterval(interval);
                       SetStatusChanged("Sending Client Info...");
                   }
               }, 3000);
           }, 1000);
        }
    </script>
</body>
</html>